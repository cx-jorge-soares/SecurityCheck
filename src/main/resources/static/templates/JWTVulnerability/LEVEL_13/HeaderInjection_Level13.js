function addEventListenerToSendHeaderButton() {
  document.getElementById("sendHeader").addEventListener("click", function () {
    const headerName = document.getElementById("headerName").value;
    const headerValue = document.getElementById("headerValue").value;

    let url = getUrlForVulnerabilityLevel();

    const manipulatedJwt =
      "eyJhbGciOiJSUzI1NiIsImtpZCI6Im1hbGljaW91cy1rZXktaWQifQ.eyJzdWIiOiJleGFtcGxldXNlciIsIm5hbWUiOiJKV1QgVXNlciIsImlhdCI6MTYwOTAxMjAwMH0.c7qHUq1HbHj8AWjKbcIYH2NZnE6PtNyXTnJTWZELvFbfbFhc5BQ_w8e24fXL2OzhhOT5qHVzFvHgOeEYFLZNGEDlJhF4o76yHsMJdWQFL4I5uZjG0o8XV0HjDdM7GqEmx2j0JHi6vJ8Q3pIqGzUBmb7bgzD4kENnP-UqfkbNl2ykYZ9Nybw_E7CAV4OxuqE4QyIpZV2VttWjefK3c6TIj9hNWvYYgipKwHFLXbOV-rOZ6K-_H_4D-kbr0LKPPX-s4b11o0wtS3y1FiHDXEvsmEjhRApEc_jk5uZY-AGPUc9Nl9t6iT_Nh1Q8Usz-jZifg03NwumJjDNtz-nS7gzg";

    doGetAjaxCall(
      function (data) {
        document.getElementById("headerResponse").innerHTML = data.isValid
          ? "Header Injection was successful!"
          : "Header Injection failed. Please try again.";
      },
      url,
      true,
      {
        [headerName]: headerValue,
        Authorization: `Bearer ${manipulatedJwt}`,
      }
    );
  });
}

addEventListenerToSendHeaderButton();
